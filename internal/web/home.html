{{- /*gotype: github.com/xperimental/netatmo-exporter/internal/web.homeContext*/ -}}
<html>
<head>
  <title>netatmo-exporter</title>
  <style>
    .button {
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .delete-button {
      background-color: #dc3545;
    }
    .authorization-button {
      background-color: #0037ff;
    }
  </style>
</head>
<body>
<h1>netatmo-exporter</h1>
{{- if .Token }}
    {{- with .Token }}
      <p>Metrics are available <a href="/metrics/v1">here (V1)</a> or <a href="/metrics/v2">here (V2)</a>.</p>
      
      <div>
        <h3>Token Management</h3>
        <p>You have a token.</p>
        <p>Token is valid until {{ .Expiry }} ({{ .Expiry | remaining }})</p>
        <form method="post" action="/auth/deletetoken" onsubmit="return confirm('Are you sure you want to delete the current token? This will require re-authentication.');">
          <button type="submit" class="button delete-button">Delete Token</button>
        </form>
      </div>
    {{- end }}
{{- else }}
  <p>Metrics are available <a href="/metrics/v1">here (V1)</a> or <a href="/metrics/v2">here (V2)</a>.</p>
      
  <div>
    <h3>Token Management</h3>
    <p>You're not authorized yet.</p>
    <p>If the <code>external-url</code> is set up correctly or you're accessing the exporter using the loopback address you can try authorizing by clicking the button below:</p>
    <form method="post" action="/auth/authorize">
      <button type="submit" class="button authorization-button">Authorize</button>
    </form>
    <p>You can also generate a token on <a href="{{ .NetAtmoDevSite }}" target="_blank">NetAtmo's developer website</a>.</p>
    <p>Make sure to select the required scopes when generating the token:
      <ul>
        <li><b>read_station</b> - for weather station data</li>
        <li><b>read_homecoach</b> - for homecoach data</li>
      </ul>
    </p>
    <p>Once you have authenticated on the website, please paste the <b>refresh token</b> into the box below:</p>
    <form method="post" action="/auth/settoken">
      <label for="refresh_token">Refresh token:</label>
      <input type="text" name="refresh_token" size="60"/>
      <input type="submit" name="submit" value="Update token"/>
    </form>
  </div>
{{- end }}
<hr/>
<p>Version information is available <a href="/version">here</a>.</p>
</body>
</html>